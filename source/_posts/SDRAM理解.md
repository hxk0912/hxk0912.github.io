---
title: SDRAM理解
date: 2019-12-08 22:54:14
categories: STM32外设使用
tags:
---

## SDRAM信号线

信号线|说明
-|-
CLK|时钟信号，在上升沿采集输入信号
CKE|输入时钟使能，禁止时钟会进入自刷新模式
CS~|片选信号，低电平有效
RAS~|行地址选通信号，低电平有效，表示行地址
CAS~|列地址选通信号，低电平有效，表示列地址
WE~|写使能信号，低电平有效
A0~A12|地址线（行\列）
BS0,BS1|BANK地址线
DQ0~15|数据线
LDQM,UDQM|数据掩码，表示DQ的有效部分

## 存储单元

### 寻址方式

SDRAM的存储单元（BANK）以阵列方式排列。同时BANK一般也有4片，分别为BANK0~3。

*寻址方式为：当寻址时，先是RAS行选，将地址输入后锁存到里面，然后BANK也会选中其中一片并锁存。然后CAS列选，然后将列地址也锁存进去。这样就完成了一次寻址。*

**W9825G6KH 的存储结构为：行地址：8192 个；列地址：512 个；BANK 数：4 个；位宽：
16 位；这样，整个芯片的容量为：8192\*512\*4\*16=32M 字节。**

### 数据传输

在实际使用的时候，我们可能会以：8 位、16 位、24 位和32 位等宽度来读写数据，这样的话，并不是每条数据线，都会被使用到，未被用到的数据线上面的数据，必须被忽略，这个时候就需要用到数据掩码（DQM）线来控制了，每一个数码线，对应8 个位的数据，低电平表示对应数据位有效，高电平表示对应数据位无效。以W9825G6KH 为例，假设以8 位数据访问，我们只需要DQ0~DQ7 的数据，而DQ8~DQ15的数据需要忽略，此时，我们只需要设置LDQM 为低电平，UDQM 为高电平，就可以了。

### 控制命令

1.Precharge

Precharge，即预充电指令，用于关闭Bank中所打开的行地址。由于SDRAM的寻址具体独占性，所以在进行完读写操作后，如果要对同一Bank的另一行进行寻址，就要将原来有效（打开）的行关闭，重新发送行/列地址。Bank关闭现有行，准备打开新行的操作就叫做预充电（Precharge）。

2.Refresh

Refresh，即刷新命令，用于刷新一行数据。SDRAM里面存储的数据，需要不断的进行刷新操作才能保留住，因此刷新命令对于SDRAM来说，尤为重要。预充电命令和刷新命令，都可以实现对 SDRAM 数据的刷新，不过预充电仅对当前打开的行有效（仅刷新当前行），而刷新命令，则可以依次对所有的行进行刷新操作。